<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			*{
				padding: 0;
				margin: 0;
			}
			body{
				height: 100%;
				width: 100%;
			}
			.wrap{
				width: 100%;
				margin: 0 auto;
				background: #DDDDDD;
				position: relative;
			}
			.wrap div{
				width: 220px;
				padding: 4px;
				border: 1px solid #000000;
				/*float: left;*/
				position: absolute;
			}
			.wrap div img{
				width: 220px;
			}
		</style>
	</head>
	<body>
		
		<div class="wrap">
			<!--<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/1.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/2.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/3.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/4.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/5.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/6.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/7.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/8.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/9.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/10.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/11.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/12.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/13.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/14.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/15.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/16.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/17.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/18.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/19.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/20.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/21.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/22.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/23.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/24.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/25.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/26.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/27.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/28.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/29.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/30.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/31.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/32.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/33.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/34.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/35.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/36.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/37.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/38.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/39.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>
			<div>
				<h3>瀑布流</h3>
				<a><img src="img/waterfall/40.jpg" alt="" /></a>
				<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>
				<span>其他内容................</span>
			</div>-->
		</div>
		
		<script src="../js/jquery-3.1.1.min.js"></script>
		<script>
			
		
			var wrap = $('.wrap');
			for (var i = 1; i <= 70; i++) {
				//html中一个单元的结构
				var tmp = '<div>'+
						  '<h3>瀑布流</h3>'+
						  '<a><img src="img/waterfall/' + i + '.jpg" alt="" /></a>'+
						  '<p>瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流瀑布流</p>'+
						  '<span>其他内容......'+ i +'.......</span>'+
						  '</div>';
						  //图片的加载是需要时间的
				//创建的元素
				var div = $(tmp);
				wrap.append(div);
			}
			
			//界面加载完毕之后调用waterfall() --- 所有的图片也已经在加载完毕
			window.onload = function(){
				waterfall();
			}
			
			window.onresize = function(){
				//窗口发生变化的时候，重新初始化一下数组，
				//因为列数发生了变化，数组元素的个数也发生了变化
				pointArr = [];
				waterfall();
			}
			//设置瀑布流，为了避免出现有一列或者几列的图片特别长，而其他的列特别短的情况
			//使用定位布局的时候，不能按照顺序去布局，每一次布局的时候先找最短的一列
			//然后把图片定位该列上
			
			
			//首先计算有几列  div -- 220 + 10 
			//body的宽 / div的宽  = n列
			//8     数组 --- > 8个对象(8个列) ---> 列的高度    间隙  （10,20,30,40,50,60,5,14）
			//数组中最小值    --- 5 -- 下一行第一张图片的top值      第七列 ---left（10,20,30,40,50,60,55,14）
			//下一行第二张图片  top - 10  第一列 left（30,20,30,40,50,60,55,14）
			
//			window.onload = function(){
//				waterfall();
//			}
			var pointArr = [],//存储每列的top left
				colCount = 0,//总的列数
				hSpace = 0,//左右的间隙
				vSpace = 0;//上下的间隙
				//divList = null;//所有的瀑布流div
			
			//一共有多少列
			function waterfall(){
				var wrap = $('.wrap');
				
				//页面一共有多少列
				colCount = Math.floor(wrap.width()/230);//取整
//				console.log(colCount);//8.1223
				//左右的间隙   (大盒子的宽 - 所有div的宽 ) /(列数 + 1)
				hSpace =  Math.floor((wrap.width() - 230*colCount)/(colCount + 1));
//				console.log(hSpace);
				//上下的间隙  10
				vSpace = 10;
				
				//创建N列的top left坐标，把值存储到数组中
				for (var i = 0; i < colCount; i++) {
					var obj = {};//创建对象，把left top存储对象中，再把对象存储到数组中
					//添加属性top
					obj.top = vSpace;
					//添加属性left
					obj.left = i*230 + (i + 1)*hSpace;
					//数组中就有了8个对象，每个对象都有每列的left top值
					pointArr.push(obj);
				}
				
				//拿到所有的瀑布流div，开始定位
				var divList = $('.wrap div');
				for (var i = 0; i < divList.length; i++) {
					
					//获取最小的列是那一列
					var index = minTopIndex();
//					console.log(index,pointArr[index].left);
					//当前的div 放到最小列上   divList[i] --DOM
					$(divList[i]).animate({
						'left' : pointArr[index].left,
						'top' : pointArr[index].top
					},1000);
					
					//修改数组里的元素的top值
					pointArr[index].top  += divList[i].offsetHeight + vSpace;
					console.log(divList[i].offsetHeight);
				}
			}
//			waterfall()
			//计算top值最小的列是哪一列
			function minTopIndex(){
				//假设第一个元素的top最小
				var minTop = pointArr[0].top;//pointArr[0]  --- obj
				var index = 0;
				//循环判断最小top
				for (var i = 0; i < pointArr.length; i++) {
					//每个元素top值都和假设的最小比较
					if(pointArr[i].top < minTop){
						//存储更小的值
						minTop = pointArr[i].top;
						index = i;
					}
				}
				//返回最小的那一列
				return index
			}
		</script>
	</body>
</html>
